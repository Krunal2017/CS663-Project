load('train_harris_sal_hists_1.mat');
h1=SALIENCY_HISTOGRAMS;
load('train_harris_sal_hists_2.mat');
h2=SALIENCY_HISTOGRAMS;
hist=cat(3,h1,h2);
load('train_harris_sal_hists_3.mat');
h3=SALIENCY_HISTOGRAMS;
hist=cat(3,hist,h3);
load('test_harris_sal_hists.mat');
test=TEST_SALIENCY_HISTOGRAMS;

%% Compute scores
M=size(hist,3);
N=size(test,3);
scores=zeros(M,N);
m=0.5;

tic;
for i=1:N
    for j=1:M
        s=similarity_score(test(:,:,i),hist(:,:,j),m);
        scores(j,i)=s;
    end
end
toc;

%% GT
D = dir('../../THUR15000/CoffeeMug/Src/*.png');
GT=zeros(M+N,1);
for i=1:length(D)
    n=D(i).name;
    num=strrep(n,'.png','');
    indices(i)=str2num(num);
end
GT(indices)=1;

%%
subGT=GT(1:length(scores));
indices=find(scores<0.08);
labels=zeros(length(indices),1);
acc=labels==subGT;
accuracy=sum(acc)*100/length(acc);
disp(strcat('Accuracy: ',num2str(accuracy),' %'));